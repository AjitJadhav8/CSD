<!-- NAVBAR -->
<div class="flex flex-col sm:flex-row items-center sm:justify-between p-2 bg-white">
  <img src="credenca-logo.png" alt="Logo" class="h-10 w-auto mb-2 sm:mb-0 px-7"
     />

    <!-- Home Button (Same Style as Other Navigation Buttons) -->
  <div *ngIf="!isAppCenterRoute()" class="flex gap-2 p-1 rounded-md">
    <a [routerLink]="['/app-center']" routerLinkActive="active-link"
      class="px-3 py-1 text-gray-700 hover:bg-blue-400 hover:text-white rounded transition cursor-pointer flex items-center">
      Home
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd"
          d="M10 2a1 1 0 01.7.3l6 6a1 1 0 11-1.4 1.4L10 4.4l-5.3 5.3a1 1 0 01-1.4-1.4l6-6A1 1 0 0110 2z"
          clip-rule="evenodd" />
        <path fill-rule="evenodd"
          d="M4 10a1 1 0 011-1h1v6a1 1 0 001 1h6a1 1 0 001-1v-6h1a1 1 0 011 1v7a1 1 0 01-1 1H5a1 1 0 01-1-1v-7z"
          clip-rule="evenodd" />
      </svg>
    </a>
  </div>


  <!-- Navbar Center (Organisation Links - Conditionally Shown) -->
  <!-- Organisation Links (Dropdown for Customer) -->
  <div *ngIf="showOrganisationLinks" class="hidden sm:flex gap-2 p-1 rounded-md flex-grow">

    <!-- Employee Dropdown -->

    <div class="relative" #employeeDropdown>
      <a (click)="toggleEmployeeDropdown()" [routerLink]="['/organisation', 'employee']" routerLinkActive="active-link"
        class="px-3 py-1 text-gray-700 hover:bg-blue-400 hover:text-white rounded transition cursor-pointer flex items-center">
        Employee
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2 transition-transform"
          [class.rotate-180]="showEmployeeDropdown" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd"
            d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
            clip-rule="evenodd" />
        </svg>
      </a>

      <!-- Dropdown Menu -->
      <div *ngIf="showEmployeeDropdown"
        class="absolute left-0 mt-1 w-52 bg-white shadow-lg rounded-md border border-gray-200 z-10">
        <a (click)="navigateToEmployeeSection('employee')" [class.active-link]="isEmployeeSectionActive('employee')"
          class="block px-4 py-2 text-gray-700 hover:bg-blue-400 hover:text-white cursor-pointer">
          Employee
        </a>
        <a (click)="navigateToEmployeeSection('department')" [class.active-link]="isEmployeeSectionActive('department')"
          class="block px-4 py-2 text-gray-700 hover:bg-blue-400 hover:text-white cursor-pointer">
          Department
        </a>
        
        <a (click)="navigateToEmployeeSection('designation')" [class.active-link]="isEmployeeSectionActive('designation')"
          class="block px-4 py-2 text-gray-700 hover:bg-blue-400 hover:text-white cursor-pointer">
          Designation
        </a>
        <a (click)="navigateToEmployeeSection('project_role')" [class.active-link]="isEmployeeSectionActive('project_role')"
          class="block px-4 py-2 text-gray-700 hover:bg-blue-400 hover:text-white cursor-pointer">
          Project Role
        </a>
        
        <a (click)="navigateToEmployeeSection('skills')" [class.active-link]="isEmployeeSectionActive('skills')"
          class="block px-4 py-2 text-gray-700 hover:bg-blue-400 hover:text-white cursor-pointer">
          Skills
        </a>
        <a (click)="navigateToEmployeeSection('reportingManagerHistory')"
          [class.active-link]="isEmployeeSectionActive('reportingManagerHistory')"
          class="block px-4 py-2 text-gray-700 hover:bg-blue-400 hover:text-white cursor-pointer">
          Reporting Manager History
        </a>
      </div>
    </div>

    <!-- Customer Dropdown -->
    <div class="relative" #customerDropdown>
      <a (click)="toggleCustomerDropdown()" [routerLink]="['/organisation', 'customer']" routerLinkActive="active-link"
        class="px-3 py-1 text-gray-700 hover:bg-blue-400 hover:text-white rounded transition cursor-pointer flex items-center">
        Customer
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2 transition-transform"
          [class.rotate-180]="showCustomerDropdown" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd"
            d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
            clip-rule="evenodd" />
        </svg>
      </a>

      <!-- Dropdown Menu -->
      <div *ngIf="showCustomerDropdown"
        class="absolute left-0 mt-1 w-44 bg-white shadow-lg rounded-md border border-gray-200 z-10">
        <a (click)="navigateToCustomerSection('customer')" [class.active-link]="isCustomerSectionActive('customer')"
          class="block px-4 py-2 text-gray-700 hover:bg-blue-400 hover:text-white cursor-pointer">
          Customer
        </a>
        <a (click)="navigateToCustomerSection('customerCategory')"
          [class.active-link]="isCustomerSectionActive('customerCategory')"
          class="block px-4 py-2 text-gray-700 hover:bg-blue-400 hover:text-white cursor-pointer">
          Customer Categories
        </a>
      </div>
    </div>

    <!-- Project Dropdown -->
    <div class="relative" #projectDropdown>
      <a (click)="toggleProjectDropdown()" [routerLink]="['/organisation', 'project']" routerLinkActive="active-link"
        class="px-3 py-1 text-gray-700 hover:bg-blue-400 hover:text-white rounded transition cursor-pointer flex items-center">
        Project
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2 transition-transform"
          [class.rotate-180]="showProjectDropdown" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd"
            d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
            clip-rule="evenodd" />
        </svg>
      </a>

      <!-- Dropdown Menu -->
      <div *ngIf="showProjectDropdown"
        class="absolute left-0 mt-1 w-44 bg-white shadow-lg rounded-md border border-gray-200 z-10">
        <a (click)="navigateToProjectSection('project')" [class.active-link]="isProjectSectionActive('project')"
          class="block px-4 py-2 text-gray-700 hover:bg-blue-400 hover:text-white cursor-pointer">
          Project
        </a>
        <a (click)="navigateToProjectSection('projectPhases')" [class.active-link]="isProjectSectionActive('projectPhases')"
      class="block px-4 py-2 text-gray-700 hover:bg-blue-400 hover:text-white cursor-pointer">
      Project Phases
    </a>
        <a (click)="navigateToProjectSection('projectDeliverable')"
          [class.active-link]="isProjectSectionActive('projectDeliverable')"
          class="block px-4 py-2 text-gray-700 hover:bg-blue-400 hover:text-white cursor-pointer">
          Project Deliverable
        </a>
        <!-- <a (click)="navigateToProjectSection('taskCategory')"
          [class.active-link]="isProjectSectionActive('taskCategory')"
          class="block px-4 py-2 text-gray-700 hover:bg-blue-400 hover:text-white cursor-pointer">
          Task Category
        </a> -->
      </div>
    </div>

    <!-- <a [routerLink]="['/organisation', 'admin']" routerLinkActive="active-link"
      class="px-3 py-1 text-gray-700 hover:bg-blue-400 hover:text-white rounded transition">
      Admin
    </a> -->
  </div>

  <!-- Navbar Center (Timesheet Links - Conditionally Shown) -->
  <div *ngIf="showTimesheetLinks" class="hidden sm:flex gap-2 p-1 rounded-md flex-grow">
    <a [routerLink]="['/timesheet', 'fill-timesheet']" routerLinkActive="active-link"
      class="px-3 py-1 text-gray-700 hover:bg-blue-400 hover:text-white rounded transition">
      Fill Timesheet
    </a>
    <!-- <a [routerLink]="['/timesheet', 'summary-report']" routerLinkActive="active-link"
    class="px-3 py-1 text-gray-700 hover:bg-blue-500 hover:text-white rounded transition">
    Timesheet Summary Report
  </a> -->
    <!-- <a [routerLink]="['/timesheet', 'fill-backdated-timesheet']" routerLinkActive="active-link"
    class="px-3 py-1 text-gray-700 hover:bg-blue-500 hover:text-white rounded transition">
    Fill Backdated Timesheet
  </a>
  <a [routerLink]="['/timesheet', 'view-my-projects']" routerLinkActive="active-link"
    class="px-3 py-1 text-gray-700 hover:bg-blue-500 hover:text-white rounded transition">
    View My Projects
  </a> -->
    <!-- <a [routerLink]="['/timesheet', 'view-timesheet']" routerLinkActive="active-link"
    class="px-3 py-1 text-gray-700 hover:bg-blue-500 hover:text-white rounded transition">
    View Timesheet
  </a> -->
    <a [routerLink]="['/timesheet', 'export-my-timesheet']" routerLinkActive="active-link"
      class="px-3 py-1 text-gray-700 hover:bg-blue-400 hover:text-white rounded transition">
      Export My Timesheet
    </a>
    <!-- <a [routerLink]="['/timesheet', 'managers-hub']" routerLinkActive="active-link"
      class="px-3 py-1 text-gray-700 hover:bg-blue-500 hover:text-white rounded transition">
      Manager's Hub
    </a> -->
    <!-- Updated Managers Hub Dropdown -->
    <div class="relative" #managersHubDropdown>
      <a (click)="toggleManagersHubDropdown()" [routerLink]="['/timesheet', 'managers-hub']" routerLinkActive="active-link"
        class="px-3 py-1 text-gray-700 hover:bg-blue-500 hover:text-white rounded transition cursor-pointer flex items-center">
        Manager's Hub
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2 transition-transform"
          [class.rotate-180]="showManagersHubDropdown" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd"
            d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
            clip-rule="evenodd" />
        </svg>
      </a>

      <!-- Dropdown Menu -->
      <div *ngIf="showManagersHubDropdown"
        class="absolute left-0 mt-1 w-52 bg-white shadow-lg rounded-md border border-gray-200 z-10">
        <a (click)="navigateToManagersHubSection('projectPhases')" 
           [class.active-link]="isManagersHubSectionActive('projectPhases')"
           class="block px-4 py-2 text-gray-700 hover:bg-blue-400 hover:text-white cursor-pointer">
          Project Phases
        </a>
        <a (click)="navigateToManagersHubSection('projectDeliverable')" 
           [class.active-link]="isManagersHubSectionActive('projectDeliverable')"
           class="block px-4 py-2 text-gray-700 hover:bg-blue-400 hover:text-white cursor-pointer">
          Project Deliverable
        </a>
      </div>
    </div>
  </div>

  <!-- Navbar Center (Resource Management Links - Conditionally Shown) -->
  <div *ngIf="showResourceManagementLinks" class="hidden sm:flex gap-2 p-1 rounded-md flex-grow">
    <!-- <a [routerLink]="['/resource-management', 'allocation-report']" routerLinkActive="active-link"
    class="px-3 py-1 text-gray-700 hover:bg-blue-500 hover:text-white rounded transition">
    Allocation Report
  </a> -->
    <a [routerLink]="['/resource-management', 'assign-project-team']" routerLinkActive="active-link"
      class="px-3 py-1 text-gray-700 hover:bg-blue-400 hover:text-white rounded transition">
      Assign Project Team
    </a>
    <a [routerLink]="['/resource-management', 'all-teams-timesheet']" routerLinkActive="active-link"
      class="px-3 py-1 text-gray-700 hover:bg-blue-400 hover:text-white rounded transition">
      All Teams Timesheet
    </a>
    <!-- 
    <a [routerLink]="['/resource-management', 'all-projects-team']" routerLinkActive="active-link"
      class="px-3 py-1 text-gray-700 hover:bg-blue-400 hover:text-white rounded transition">
      All Projects Team
    </a>
    <a [routerLink]="['/resource-management', 'view-resource-demand']" routerLinkActive="active-link"
      class="px-3 py-1 text-gray-700 hover:bg-blue-400 hover:text-white rounded transition">
      View Resource Demand
    </a>
    <a [routerLink]="['/resource-management', 'view-update-employee-skills']" routerLinkActive="active-link"
      class="px-3 py-1 text-gray-700 hover:bg-blue-400 hover:text-white rounded transition">
      View/Update Employee Skills
    </a> -->
  </div>

  <!-- Navbar Right Section -->
  <div class="flex flex-col sm:flex-row items-center gap-2 sm:gap-6 mt-2 sm:mt-0">
    <!-- User Dropdown -->
    <div class="relative">
      <button (click)="toggleDropdown()"
        class="flex items-center text-gray-700 font-medium text-sm sm:text-base cursor-pointer px-4 py-2 rounded-lg transition-all hover:bg-gray-100">
        <img src="user.png" alt="User Icon" class="h-6 w-6 mr-2" />
        <span>Welcome, {{ loggedInUserName }}</span>
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2 transition-transform"
          [class.rotate-180]="showDropdown" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd"
            d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
            clip-rule="evenodd" />
        </svg>
      </button>

      <!-- Dropdown Menu -->
      <div *ngIf="showDropdown"
        class="absolute right-0 mt-2 w-52 bg-white shadow-lg rounded-lg overflow-hidden border border-gray-200 z-10">
        <button class="flex items-center w-full text-base text-gray-700 hover:bg-gray-100 transition px-4 py-3"
          (click)="showChangePasswordForm = !showChangePasswordForm" (click)="openChangePasswordModal()">
          <img src="change-password.png" alt="Change Password Icon" class="h-5 w-5 mr-2" />
          Change Password
        </button>
        <!-- <button class="flex items-center w-full text-base text-gray-700 hover:bg-gray-100 transition px-4 py-3"
          (click)="showUpdateEmailForm = !showUpdateEmailForm">
          <img src="email.png" alt="Update Email Icon" class="h-5 w-5 mr-2" />
          Update Email
        </button> -->
        <button class="flex items-center w-full text-base text-red-600 hover:bg-red-100 transition px-4 py-3"
          (click)="logout()">
          <img src="logout.png" alt="Logout Icon" class="h-5 w-5 mr-2" />
          Logout
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Custom Modal for Change Password -->
<div *ngIf="showChangePasswordModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg p-6 w-full max-w-md">
    <h2 class="text-xl font-semibold mb-4">Change Password</h2>
    <form #changePasswordForm="ngForm" (ngSubmit)="onChangePasswordSubmit(changePasswordForm)">
      <!-- Current Password -->
      <div class="form-group mb-4">
        <label class="block mb-2 font-semibold">Current Password*</label>
        <input type="password" required class="border p-2 w-full rounded-md"
          [(ngModel)]="changePasswordData.currentPassword" #currentPassword="ngModel" name="currentPassword">
        <span class="text-red-500 text-sm" *ngIf="currentPassword.invalid && currentPassword.touched">
          Current Password is required
        </span>
      </div>

      <!-- New Password -->
      <div class="form-group mb-4">
        <label class="block mb-2 font-semibold">New Password*</label>
        <input type="password" required class="border p-2 w-full rounded-md"
          [(ngModel)]="changePasswordData.newPassword" #newPassword="ngModel" name="newPassword">
        <span class="text-red-500 text-sm" *ngIf="newPassword.invalid && newPassword.touched">
          New Password is required
        </span>
      </div>

      <!-- Confirm New Password -->
      <div class="form-group mb-4">
        <label class="block mb-2 font-semibold">Confirm New Password*</label>
        <input type="password" required class="border p-2 w-full rounded-md"
          [(ngModel)]="changePasswordData.confirmNewPassword" #confirmNewPassword="ngModel" name="confirmNewPassword">
        <span class="text-red-500 text-sm" *ngIf="confirmNewPassword.invalid && confirmNewPassword.touched">
          Confirm New Password is required
        </span>
      </div>

      <!-- Form Actions -->
      <div class="flex justify-end gap-4">
        <button type="button" class="bg-gray-500 text-white px-4 py-2 rounded"
          (click)="closeChangePasswordModal()">Cancel</button>
        <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">Save</button>
      </div>
    </form>
  </div>
</div>