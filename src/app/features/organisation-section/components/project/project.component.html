<div class="p-4">

  <div *ngIf="selectedSection === 'projectPhases'">
    <h3 class="text-xl font-semibold mb-4">Add New Project Phase</h3>

    <form #projectPhaseFormRef="ngForm" (ngSubmit)="submitProjectPhase(projectPhaseFormRef)">
      <div class="grid grid-cols-6 gap-4">
        <div class="form-group">
          <label class="block mb-2 font-semibold">Customer Name*</label>
          <ng-select [(ngModel)]="projectPhaseForm.customer_id" #customerField="ngModel" name="customer_id" required
            (change)="filterProjectsForPhases()"
            [ngClass]="{'border-red-500': (customerField.invalid && customerField.touched) || (projectPhaseFormRef.submitted && customerField.invalid)}"
            class="custom-ng-select">
            <ng-option [value]="" disabled selected>Select Customer</ng-option>
            <ng-option *ngFor="let customer of optionCustomers" [value]="customer.customer_id">
              {{ customer.customer_name }}
            </ng-option>
          </ng-select>
          <span class="text-red-500 text-sm"
            *ngIf="customerField.invalid && (customerField.touched || projectPhaseFormRef.submitted)">
            Customer is required.
          </span>
        </div>

        <!-- Project Selection -->
        <div class="form-group">
          <label class="block mb-2 font-semibold">Project*</label>
          <ng-select [(ngModel)]="projectPhaseForm.project_id" #projectField="ngModel" name="project_id" required
            (change)="filterDeliverablesForPhases()" [disabled]="!projectPhaseForm.customer_id"
            [ngClass]="{'border-red-500': (projectField.invalid && projectField.touched) || (projectPhaseFormRef.submitted && projectField.invalid)}"
            class="custom-ng-select">
            <ng-option [value]="" disabled selected>Select Project</ng-option>
            <ng-option *ngFor="let project of filteredProjects" [value]="project.project_id">
              {{ project.project_name }}
            </ng-option>
          </ng-select>
          <span class="text-red-500 text-sm"
            *ngIf="projectField.invalid && (projectField.touched || projectPhaseFormRef.submitted)">
            Project is required.
          </span>
        </div>


        <!-- Deliverable Selection -->
        <div class="form-group">
          <label class="block mb-2 font-semibold">Deliverable*</label>
          <ng-select [(ngModel)]="projectPhaseForm.pd_id" #deliverableField="ngModel" name="pd_id" required
            [disabled]="!projectPhaseForm.project_id"
            [ngClass]="{'border-red-500': (deliverableField.invalid && deliverableField.touched) || (projectPhaseFormRef.submitted && deliverableField.invalid)}"
            class="custom-ng-select">
            <ng-option [value]="" disabled selected>Select Deliverable</ng-option>
            <ng-option *ngFor="let deliverable of filteredDeliverables" [value]="deliverable.pd_id">
              {{ deliverable.project_deliverable_name }}
            </ng-option>
          </ng-select>
          <span class="text-red-500 text-sm"
            *ngIf="deliverableField.invalid && (deliverableField.touched || projectPhaseFormRef.submitted)">
            Deliverable is required.
          </span>
        </div>



        <!-- Phase Name -->
        <div class="form-group">
          <label class="block mb-2 font-semibold">Phase Name*</label>
          <input type="text" [(ngModel)]="projectPhaseForm.project_phase_name" #phaseField="ngModel"
            name="project_phase_name" required class="border p-2 w-full rounded-md" placeholder="Enter phase name"
            [ngClass]="{'border-red-500': (phaseField.invalid && phaseField.touched) || (projectPhaseFormRef.submitted && phaseField.invalid)}" />
          <span class="text-red-500 text-sm"
            *ngIf="phaseField.invalid && (phaseField.touched || projectPhaseFormRef.submitted)">
            Phase name is required.
          </span>
        </div>

      </div>

      <!-- Save Button -->
      <div class="mt-4">
        <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded m-2">Save</button>
      </div>
    </form>  

    <div class="rounded-lg w-full overflow-x-auto mt-6">
      <div class="min-w-max">
        <div
          class="flex flex-wrap items-center justify-between gap-x-2 gap-y-4 mb-4 py-2 bg-gray-50 rounded shadow-sm w-full">

          <div class="relative flex-grow">
            <label class="block text-xs font-medium mb-1">Customer</label>
            <ng-select [(ngModel)]="phaseCustomerFilter" (change)="applyPhaseFilters()"
              class="text-xs custom-ng-select-filter" [clearable]="true" [searchable]="true">
              <ng-option [value]="">All Customers</ng-option>
              <ng-option *ngFor="let customer of optionCustomers" [value]="customer.customer_name">
                {{ customer.customer_name }}
              </ng-option>
            </ng-select>
          </div>

          <!-- Project Filter -->
          <div class="relative flex-grow">
            <label class="block text-xs font-medium mb-1">Project</label>
            <ng-select [(ngModel)]="phaseProjectFilter" (change)="applyPhaseFilters()"
              class="text-xs custom-ng-select-filter" [clearable]="true" [searchable]="true">
              <ng-option [value]="">All Projects</ng-option>
              <ng-option *ngFor="let project of optionProject" [value]="project.project_name">
                {{ project.project_name }}
              </ng-option>
            </ng-select>
          </div>

          <!-- Deliverable Filter -->
          <div class="relative flex-grow">
            <label class="block text-xs font-medium mb-1">Deliverable</label>
            <ng-select [(ngModel)]="phaseDeliverableFilter" (change)="applyPhaseFilters()"
              class="text-xs custom-ng-select-filter" [clearable]="true" [searchable]="true">
              <ng-option [value]="">All Deliverables</ng-option>
              <ng-option *ngFor="let deliverable of optionDeliverables" [value]="deliverable.project_deliverable_name">
                {{ deliverable.project_deliverable_name }}
              </ng-option>
            </ng-select>
          </div>

          <!-- Phase Filter -->
          <!-- Phase Filter -->
          <div class="relative flex-grow">
            <label class="block text-xs font-medium mb-1">Phase</label>
            <input type="text" [(ngModel)]="phaseNameFilter" (input)="applyPhaseFilters()" placeholder="Search Phase"
              class="text-xs border border-gray-300 rounded px-1 py-1 w-full focus:outline-none focus:ring focus:ring-blue-300" />
          </div>


          <!-- Clear All Filters -->
          <button (click)="clearPhaseFilters()"
            class="text-xs bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600 focus:outline-none flex-grow-0">Clear
            All Filters</button>
        </div>
      </div>

      <!-- Scrollable Table -->
      <div class="rounded-lg w-full inline-block whitespace-nowrap">
        <table class="w-full border-collapse border border-gray-300 mt-4">
          <thead>
            <tr class="bg-gray-100">
              <th class="border p-2">Sr No</th>
              <th class="border p-2">Customer Name</th>
              <th class="border p-2">Project Name</th>
              <th class="border p-2">Deliverable</th>
              <th class="border p-2">Phase Name</th>
              <th class="border p-2">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let phase of paginatedProjectPhases; let i = index" class="hover:bg-gray-50">
              <td class="border p-2">{{ i + 1 }}</td>
              <td class="border p-2">{{ phase.customer_name }}</td>
              <td class="border p-2">{{ phase.project_name }}</td>
              <td class="border p-2">{{ phase.project_deliverable_name }}</td>
              <td class="border p-2">{{ phase.project_phase_name }}</td>
              <td class="border p-2">
                <button class="bg-blue-500 text-white px-2 py-1 rounded mr-2" 
            (click)="openEditPhaseModal(phase)">
        Edit
    </button>
                <button class="bg-red-500 text-white px-2 py-1 rounded"
                  (click)="deleteProjectPhase(phase.phase_id)">Delete</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Pagination Controls -->
    <div class="flex items-center justify-center mt-4 space-x-1">
      <button (click)="changePhasePage(phaseCurrentPage - 1)" [disabled]="phaseCurrentPage === 1"
        class="px-3 py-1 border rounded-md">
        Previous
      </button>
      <button *ngIf="phaseCurrentPage > 3" (click)="changePhasePage(1)" class="px-3 py-1 border rounded-md">1</button>
      <span *ngIf="phaseCurrentPage > 4" class="px-2">...</span>
      <button *ngFor="let page of getVisiblePhasePageNumbers()" (click)="changePhasePage(page)"
        [class.bg-blue-500]="phaseCurrentPage === page" class="px-3 py-1 border rounded-md">{{ page }}</button>
      <span *ngIf="phaseCurrentPage < phaseTotalPages - 3" class="px-2">...</span>
      <button *ngIf="phaseCurrentPage < phaseTotalPages - 2" (click)="changePhasePage(phaseTotalPages)"
        class="px-3 py-1 border rounded-md">{{ phaseTotalPages }}</button>
      <button (click)="changePhasePage(phaseCurrentPage + 1)" [disabled]="phaseCurrentPage === phaseTotalPages"
        class="px-3 py-1 border rounded-md">Next</button>
    </div>

    <div *ngIf="isEditPhaseModalOpen" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000]" (click)="closeEditPhaseModal()">
      <div class="bg-white p-6 rounded-lg w-auto" (click)="$event.stopPropagation()">
          <h3 class="text-xl font-semibold mb-4">Edit Project Phase</h3>
          <form #editPhaseForm="ngForm" (ngSubmit)="updateProjectPhase(editPhaseForm); $event.preventDefault()">
              <div class="grid grid-cols-6 gap-4">
                  <!-- Customer Selection -->
                  <div class="form-group">
                      <label class="block mb-2 font-semibold">Customer*</label>
                      <ng-select [(ngModel)]="editPhaseData.customer_id" #customerField="ngModel" 
                                name="customer_id" required (change)="onEditCustomerChangePhase()"
                                [ngClass]="{'border-red-500': (editPhaseForm.submitted || customerField?.touched) && customerField?.invalid}"
                                class="custom-ng-select">
                          <ng-option [value]="" disabled selected>Select Customer</ng-option>
                          <ng-option *ngFor="let customer of optionCustomers" [value]="customer.customer_id">
                              {{ customer.customer_name }}
                          </ng-option>
                      </ng-select>
                      <span class="text-red-500 text-sm" 
                            *ngIf="(editPhaseForm.submitted || customerField?.touched) && customerField?.invalid">
                          Customer is required.
                      </span>
                  </div>
    
                  <!-- Project Selection -->
                  <div class="form-group">
                      <label class="block mb-2 font-semibold">Project*</label>
                      <ng-select [(ngModel)]="editPhaseData.project_id" #projectField="ngModel" 
                                name="project_id" required (change)="onEditProjectChangePhase()"
                                [disabled]="!editPhaseData.customer_id"
                                [ngClass]="{'border-red-500': (editPhaseForm.submitted || projectField?.touched) && projectField?.invalid}"
                                class="custom-ng-select">
                          <ng-option [value]="" disabled selected>Select Project</ng-option>
                          <ng-option *ngFor="let project of filteredEditProjects" [value]="project.project_id">
                              {{ project.project_name }}
                          </ng-option>
                      </ng-select>
                      <span class="text-red-500 text-sm" 
                            *ngIf="(editPhaseForm.submitted || projectField?.touched) && projectField?.invalid">
                          Project is required.
                      </span>
                  </div>
    
                  <!-- Deliverable Selection -->
                  <div class="form-group">
                      <label class="block mb-2 font-semibold">Deliverable*</label>
                      <ng-select [(ngModel)]="editPhaseData.pd_id" #deliverableField="ngModel" 
                                name="pd_id" required [disabled]="!editPhaseData.project_id"
                                [ngClass]="{'border-red-500': (editPhaseForm.submitted || deliverableField?.touched) && deliverableField?.invalid}"
                                class="custom-ng-select">
                          <ng-option [value]="" disabled selected>Select Deliverable</ng-option>
                          <ng-option *ngFor="let deliverable of filteredEditDeliverables" [value]="deliverable.pd_id">
                              {{ deliverable.project_deliverable_name }}
                          </ng-option>
                      </ng-select>
                      <span class="text-red-500 text-sm" 
                            *ngIf="(editPhaseForm.submitted || deliverableField?.touched) && deliverableField?.invalid">
                          Deliverable is required.
                      </span>
                  </div>
    
                  <!-- Phase Name Field -->
                  <div class="form-group">
                      <label class="block mb-2 font-semibold">Phase Name*</label>
                      <input type="text" class="border p-2 w-full rounded-md" 
                             [(ngModel)]="editPhaseData.project_phase_name" #phaseNameField="ngModel" 
                             name="project_phase_name" required
                             [ngClass]="{'border-red-500': (editPhaseForm.submitted || phaseNameField?.touched) && phaseNameField?.invalid}">
                      <span class="text-red-500 text-sm" 
                            *ngIf="(editPhaseForm.submitted || phaseNameField?.touched) && phaseNameField?.invalid">
                          Phase name is required.
                      </span>
                  </div>
              </div>
              <div class="mt-4 flex justify-end">
                  <button type="button" class="bg-gray-500 text-white px-4 py-2 rounded mr-2" 
                          (click)="closeEditPhaseModal()">Cancel</button>
                  <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">Update</button>
              </div>
          </form>
      </div>
    </div>
  </div>

  <!-- Project Deliverable Section -->
  <div *ngIf="selectedSection === 'projectDeliverable'">
    <h3 class="text-xl font-semibold mb-4">Add New Project Deliverable</h3>

    <form #projectDeliverableFormRef="ngForm" (ngSubmit)="submitProjectDeliverable(projectDeliverableFormRef)">
      <!-- Select Customer -->
      <div class="grid grid-cols-6 gap-4">

        <!-- Customer Selection -->
        <div class="form-group">
          <label class="block mb-2 font-semibold">Customer Name*</label>
          <ng-select [(ngModel)]="projectDeliverableForm.customer_id" #customerField="ngModel" name="customer_id"
            required (change)="filterProjectsByCustomer()"
            [ngClass]="{'border-red-500': (customerField.invalid && customerField.touched) || (projectDeliverableFormRef.submitted && customerField.invalid)}"
            class="custom-ng-select">
            <ng-option [value]="" disabled selected>Select Customer</ng-option>
            <ng-option *ngFor="let customer of optionCustomers" [value]="customer.customer_id">
              {{ customer.customer_name }}
            </ng-option>
          </ng-select>
          <span class="text-red-500 text-sm"
            *ngIf="customerField.invalid && (customerField.touched || projectDeliverableFormRef.submitted)">
            Customer is required.
          </span>
        </div>

        <!-- Project Selection -->
        <div class="form-group">
          <label class="block mb-2 font-semibold">Select Project*</label>
          <ng-select [(ngModel)]="projectDeliverableForm.project_id" #projectField="ngModel" name="project_id" required
            [disabled]="!projectDeliverableForm.customer_id"
            [ngClass]="{'border-red-500': (projectField.invalid && projectField.touched) || (projectDeliverableFormRef.submitted && projectField.invalid)}"
            class="custom-ng-select">
            <ng-option [value]="" disabled selected>Select Project</ng-option>
            <ng-option *ngFor="let project of filteredProjects" [value]="project.project_id">
              {{ project.project_name }}
            </ng-option>
          </ng-select>
          <span class="text-red-500 text-sm"
            *ngIf="projectField.invalid && (projectField.touched || projectDeliverableFormRef.submitted)">
            Project is required.
          </span>
        </div>


        <!-- Deliverable Name -->
        <div class="form-group">
          <label class="block mb-2 font-semibold">Project Deliverable*</label>
          <input type="text" [(ngModel)]="projectDeliverableForm.project_deliverable_name" #deliverableField="ngModel"
            name="project_deliverable_name" required class="border p-2 w-full rounded-md"
            placeholder="Enter deliverable name"
            [ngClass]="{'border-red-500': (deliverableField.invalid && deliverableField.touched) || (projectDeliverableFormRef.submitted && deliverableField.invalid)}" />
          <span class="text-red-500 text-sm"
            *ngIf="deliverableField.invalid && (deliverableField.touched || projectDeliverableFormRef.submitted)">
            Deliverable name is required.
          </span>
        </div>

      </div>

      <!-- Save Button -->
      <div class="mt-4">
        <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded m-2">Save</button>
      </div>
    </form>
    <!-- Edit Deliverable Modal -->
<!-- Edit Deliverable Modal -->
<div *ngIf="isEditDeliverableModalOpen" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000]" (click)="closeEditDeliverableModal()">
  <div class="bg-white p-6 rounded-lg w-auto" (click)="$event.stopPropagation()">
      <h3 class="text-xl font-semibold mb-4">Edit Project Deliverable</h3>
      <form #editDeliverableForm="ngForm" (ngSubmit)="updateProjectDeliverable(editDeliverableForm); $event.preventDefault()">
          <div class="grid grid-cols-6 gap-4">
              <!-- Customer Selection -->
              <div class="form-group">
                  <label class="block mb-2 font-semibold">Customer Name*</label>
                  <ng-select [(ngModel)]="editDeliverableData.customer_id" #editCustomerField="ngModel" 
                            name="editCustomerId" required (change)="onEditCustomerChange()"
                            [ngClass]="{'border-red-500': (editDeliverableForm.submitted || editCustomerField?.touched) && editCustomerField?.invalid}"
                            class="custom-ng-select">
                      <ng-option [value]="" disabled selected>Select Customer</ng-option>
                      <ng-option *ngFor="let customer of optionCustomers" [value]="customer.customer_id">
                          {{ customer.customer_name }}
                      </ng-option>
                  </ng-select>
                  <span class="text-red-500 text-sm" 
                        *ngIf="(editDeliverableForm.submitted || editCustomerField?.touched) && editCustomerField?.invalid">
                      Customer is required.
                  </span>
              </div>

              <!-- Project Selection -->
              <div class="form-group">
                  <label class="block mb-2 font-semibold">Project Name*</label>
                  <ng-select [(ngModel)]="editDeliverableData.project_id" #editProjectField="ngModel" 
                            name="editProjectId" required [disabled]="!editDeliverableData.customer_id"
                            [ngClass]="{'border-red-500': (editDeliverableForm.submitted || editProjectField?.touched) && editProjectField?.invalid}"
                            class="custom-ng-select">
                      <ng-option [value]="" disabled selected>Select Project</ng-option>
                      <ng-option *ngFor="let project of filteredEditProjects" [value]="project.project_id">
                          {{ project.project_name }}
                      </ng-option>
                  </ng-select>
                  <span class="text-red-500 text-sm" *ngIf="(editDeliverableForm.submitted || editProjectField?.touched) && editProjectField?.invalid">
                      Project is required.
                  </span>
              </div>

              <!-- Deliverable Name Field -->
              <div class="form-group">
                  <label class="block mb-2 font-semibold">Deliverable Name*</label>
                  <input type="text" class="border p-2 w-full rounded-md" 
                         [(ngModel)]="editDeliverableData.project_deliverable_name" #editDeliverableNameField="ngModel" 
                         name="editDeliverableName" required
                         [ngClass]="{'border-red-500': (editDeliverableForm.submitted || editDeliverableNameField?.touched) && editDeliverableNameField?.invalid}">
                  <span class="text-red-500 text-sm" 
                        *ngIf="(editDeliverableForm.submitted || editDeliverableNameField?.touched) && editDeliverableNameField?.invalid">
                      Deliverable name is required.
                  </span>
              </div>
          </div>
          <div class="mt-4 flex justify-end">
              <button type="button" class="bg-gray-500 text-white px-4 py-2 rounded mr-2" 
                      (click)="closeEditDeliverableModal()">Cancel</button>
              <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">Update</button>
          </div>
      </form>
  </div>
</div>


    <div class="rounded-lg w-full overflow-x-auto">
      <!-- Filter Section -->
      <div class="min-w-max">
        <div
          class="flex flex-wrap items-center justify-between gap-x-2 gap-y-4 mb-4 py-2 bg-gray-50 rounded shadow-sm w-full">


          <div class="relative flex-grow">
            <label class="block text-xs font-medium mb-1">Customer</label>
            <ng-select [(ngModel)]="customerNameFilter" (change)="applyDeliverableFilters()"
              class="text-xs custom-ng-select-filter" [clearable]="true" [searchable]="true">
              <ng-option [value]="">All Customers</ng-option>
              <ng-option *ngFor="let customer of optionCustomers" [value]="customer.customer_id">
                {{ customer.customer_name }}
              </ng-option>
            </ng-select>
          </div>

          <div class="relative flex-grow">
            <label class="block text-xs font-medium mb-1">Project</label>
            <ng-select [(ngModel)]="projectNameFilter" (change)="applyDeliverableFilters()"
              class="text-xs custom-ng-select-filter" [clearable]="true" [searchable]="true">
              <ng-option [value]="">All Projects</ng-option>
              <ng-option *ngFor="let project of optionProject" [value]="project.project_id">
                {{ project.project_name }}
              </ng-option>
            </ng-select>
          </div>

          <!-- Deliverable Filter -->
          <div class="relative flex-grow">
            <label class="block text-xs font-medium mb-1">Deliverable</label>
            <input type="text" [(ngModel)]="deliverableNameFilter" (input)="applyDeliverableFilters()"
              placeholder="Search Deliverable"
              class="text-xs border border-gray-300 rounded px-1 py-1 w-full focus:outline-none focus:ring focus:ring-blue-300" />
          </div>
          <!-- Clear All Filters -->
          <button (click)="clearDeliverableFilters()"
            class="text-xs bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600 focus:outline-none flex-grow-0">Clear
            All Filters</button>
        </div>
      </div>

      <!-- Scrollable Table -->
      <div class="rounded-lg w-full inline-block whitespace-nowrap">
        <table class="w-full border-collapse border border-gray-300 mt-4">
          <thead>
            <tr class="bg-gray-100">
              <th class="border p-2">Sr No</th>
              <th class="border p-2">Customer Name</th>
              <th class="border p-2">Project Name</th>
              <th class="border p-2">Deliverable Name</th>
              <th class="border p-2">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let deliverable of paginatedProjectDeliverables; let i = index" class="hover:bg-gray-50">
              <td class="border p-2">{{ i + 1 }}</td>
              <td class="border p-2">{{ deliverable.customer_name }}</td>
              <td class="border p-2">{{ deliverable.project_name }}</td>
              <td class="border p-2">{{ deliverable.project_deliverable_name }}</td>
              <td class="border p-2">
                <button class="bg-blue-500 text-white px-2 py-1 rounded mr-2" 
            (click)="openEditDeliverableModal(deliverable)">
        Edit
    </button>
                <button class="bg-red-500 text-white px-2 py-1 rounded"
                  (click)="deleteProjectDeliverable(deliverable.pd_id)">Delete</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="flex items-center justify-center mt-4 space-x-1">
      <button (click)="changeDeliverablePage(deliverableCurrentPage - 1)" [disabled]="deliverableCurrentPage === 1"
        class="px-3 py-1 border rounded-md">
        Previous
      </button>

      <button *ngIf="deliverableCurrentPage > 3" (click)="changeDeliverablePage(1)" class="px-3 py-1 border rounded-md">
        1
      </button>

      <span *ngIf="deliverableCurrentPage > 4" class="px-2">...</span>

      <button *ngFor="let page of getVisibleDeliverablePageNumbers()" (click)="changeDeliverablePage(page)"
        [class.bg-blue-500]="deliverableCurrentPage === page" class="px-3 py-1 border rounded-md">
        {{ page }}
      </button>

      <span *ngIf="deliverableCurrentPage < deliverableTotalPages - 3" class="px-2">...</span>

      <button *ngIf="deliverableCurrentPage < deliverableTotalPages - 2"
        (click)="changeDeliverablePage(deliverableTotalPages)" class="px-3 py-1 border rounded-md">
        {{ deliverableTotalPages }}
      </button>

      <button (click)="changeDeliverablePage(deliverableCurrentPage + 1)"
        [disabled]="deliverableCurrentPage === deliverableTotalPages" class="px-3 py-1 border rounded-md">
        Next
      </button>
    </div>
  </div>


  <div *ngIf="selectedSection === 'project'">
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 m-4">

    <div class="mb-6 pb-4 border-b border-gray-200">
      <h3 class="text-lg font-semibold text-gray-800 flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
        </svg>
        Add New Project
      </h3>
      <p class="text-xs text-gray-500 mt-1">Fill all required fields (*) to create new project</p>
    </div>
        <!-- <form #projectNgForm="ngForm" (ngSubmit)="submitProject(projectNgForm)">
      <div class="grid grid-cols-6 gap-4">

        <div class="form-group">
          <label class="block mb-2 font-semibold">Customer Name*</label>
          <ng-select required class="custom-ng-select" [(ngModel)]="projectForm.customer_id" #customerId="ngModel"
            name="customer_id"
            [ngClass]="{'border-red-500': (customerId.invalid && customerId.touched) || (projectNgForm.submitted && customerId.invalid)}">
            <ng-option [value]="" disabled selected>Select Customer</ng-option>
            <ng-option *ngFor="let customer of optionCustomers" [value]="customer.customer_id">
              {{ customer.customer_name }}
            </ng-option>
          </ng-select>
          <span class="text-red-500 text-sm"
            *ngIf="(customerId.invalid && customerId.touched) || (projectNgForm.submitted && customerId.invalid)">
            Customer Name is required
          </span>
        </div>

        <div class="form-group">
          <label class="block mb-2 font-semibold">Project Name*</label>
          <input type="text" required class="border p-2 w-full rounded-md" [(ngModel)]="projectForm.project_name"
            #projectName="ngModel" name="project_name"
            [ngClass]="{'border-red-500': (projectName.invalid && projectName.touched) || (projectNgForm.submitted && projectName.invalid)}">
          <span class="text-red-500 text-sm"
            *ngIf="(projectName.invalid && projectName.touched) || (projectNgForm.submitted && projectName.invalid)">
            Project Name is required
          </span>
        </div>

        <div class="form-group">
          <label class="block mb-2 font-semibold">Planned Start Date*</label>
          <input type="date" required class="border p-2 w-full rounded-md" [(ngModel)]="projectForm.planned_start_date"
            #plannedStartDate="ngModel" name="planned_start_date"
            [ngClass]="{'border-red-500': (plannedStartDate.invalid && plannedStartDate.touched) || (projectNgForm.submitted && plannedStartDate.invalid)}">
          <span class="text-red-500 text-sm"
            *ngIf="(plannedStartDate.invalid && plannedStartDate.touched) || (projectNgForm.submitted && plannedStartDate.invalid)">
            Planned Start Date is required
          </span>
        </div>

        <div class="form-group">
          <label class="block mb-2 font-semibold">Actual Start Date*</label>
          <input type="date" required class="border p-2 w-full rounded-md" [(ngModel)]="projectForm.actual_start_date"
            #actualStartDate="ngModel" name="actual_start_date"
            [ngClass]="{'border-red-500': (actualStartDate.invalid && actualStartDate.touched) || (projectNgForm.submitted && actualStartDate.invalid)}">
          <span class="text-red-500 text-sm"
            *ngIf="(actualStartDate.invalid && actualStartDate.touched) || (projectNgForm.submitted && actualStartDate.invalid)">
            Actual Start Date is required
          </span>
        </div>
        <div class="form-group">
          <label class="block mb-2 font-semibold">Type of Project*</label>
          <ng-select required class="custom-ng-select" [(ngModel)]="projectForm.type_of_project_id"
            #typeOfProjectId="ngModel" name="type_of_project_id"
            [ngClass]="{'border-red-500': (typeOfProjectId.invalid && typeOfProjectId.touched) || (projectNgForm.submitted && typeOfProjectId.invalid)}">
            <ng-option [value]="" disabled selected>Select Type</ng-option>
            <ng-option *ngFor="let project of optionTypeOfProject" [value]="project.type_of_project_id">
              {{ project.project_type_name }}
            </ng-option>
          </ng-select>
          <span class="text-red-500 text-sm"
            *ngIf="(typeOfProjectId.invalid && typeOfProjectId.touched) || (projectNgForm.submitted && typeOfProjectId.invalid)">
            Type of Project is required
          </span>
        </div>

        <div class="form-group">
          <label class="block mb-2 font-semibold">Type of Engagement*</label>
          <ng-select required class="custom-ng-select" [(ngModel)]="projectForm.type_of_engagement_id"
            #typeOfEngagementId="ngModel" name="type_of_engagement_id"
            [ngClass]="{'border-red-500': (typeOfEngagementId.invalid && typeOfEngagementId.touched) || (projectNgForm.submitted && typeOfEngagementId.invalid)}">
            <ng-option [value]="" disabled selected>Select Type of Engagement</ng-option>
            <ng-option *ngFor="let engagement of optionTypeOfEngagement" [value]="engagement.type_of_engagement_id">
              {{ engagement.type_of_engagement_name }}
            </ng-option>
          </ng-select>
          <span class="text-red-500 text-sm"
            *ngIf="(typeOfEngagementId.invalid && typeOfEngagementId.touched) || (projectNgForm.submitted && typeOfEngagementId.invalid)">
            Type of Engagement is required
          </span>
        </div>

        <div class="form-group">
          <label class="block mb-2 font-semibold">Project Manager*</label>
          <ng-select required class="custom-ng-select" [(ngModel)]="projectForm.project_manager_id"
            #projectManagerId="ngModel" name="project_manager_id"
            [ngClass]="{'border-red-500': (projectManagerId.invalid && projectManagerId.touched) || (projectNgForm.submitted && projectManagerId.invalid)}">
            <ng-option [value]="" disabled selected>Select Project Manager</ng-option>
            <ng-option *ngFor="let user of optionUsers" [value]="user.user_id">
              {{ user.user_first_name }} {{ user.user_last_name }}
            </ng-option>
          </ng-select>
          <span class="text-red-500 text-sm"
            *ngIf="(projectManagerId.invalid && projectManagerId.touched) || (projectNgForm.submitted && projectManagerId.invalid)">
            Project Manager is required
          </span>
        </div>

        <div class="form-group">
          <label class="block mb-2 font-semibold">Project Status*</label>
          <ng-select required class="custom-ng-select" [(ngModel)]="projectForm.project_status_id"
            #projectStatusId="ngModel" name="project_status_id"
            [ngClass]="{'border-red-500': (projectStatusId.invalid && projectStatusId.touched) || (projectNgForm.submitted && projectStatusId.invalid)}">
            <ng-option [value]="" disabled selected>Select Status</ng-option>
            <ng-option *ngFor="let status of optionProjectStatus" [value]="status.project_status_id">
              {{ status.status_name }}
            </ng-option>
          </ng-select>
          <span class="text-red-500 text-sm"
            *ngIf="(projectStatusId.invalid && projectStatusId.touched) || (projectNgForm.submitted && projectStatusId.invalid)">
            Project Status is required
          </span>
        </div>

        <div class="form-group">
          <label class="block mb-2 font-semibold">Tentative End Date*</label>
          <input type="date" required class="border p-2 w-full rounded-md" [(ngModel)]="projectForm.tentative_end_date"
            #tentativeEndDate="ngModel" name="tentative_end_date"
            [ngClass]="{'border-red-500': (tentativeEndDate.invalid && tentativeEndDate.touched) || (projectNgForm.submitted && tentativeEndDate.invalid)}">
          <span class="text-red-500 text-sm"
            *ngIf="(tentativeEndDate.invalid && tentativeEndDate.touched) || (projectNgForm.submitted && tentativeEndDate.invalid)">
            Tentative End Date is required
          </span>
        </div>
        <div class="form-group">
          <label class="block mb-2 font-semibold">Project Description</label>
          <textarea class="border p-2 w-full rounded-md" rows="3" placeholder="Enter project details..."
            [(ngModel)]="projectForm.project_description" name="project_description"></textarea>
        </div>
      </div>


      <div class="mt-4">
        <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded m-2">Create Project</button>
      </div>
    </form> -->

    <form #projectNgForm="ngForm" (ngSubmit)="submitProject(projectNgForm); $event.preventDefault()">
      <div class="grid grid-cols-6 gap-4">
        <!-- Customer Name -->
        <div class="space-y-1">
          <label class="text-xs font-medium text-gray-600">Customer Name*</label>
          <ng-select required class="text-xs custom-ng-select" [(ngModel)]="projectForm.customer_id" #customerId="ngModel"
            name="customer_id"
            [ngClass]="{'border-red-500': (customerId.invalid && customerId.touched) || (projectNgForm.submitted && customerId.invalid)}">
            <ng-option [value]="" disabled selected>Select Customer</ng-option>
            <ng-option *ngFor="let customer of optionCustomers" [value]="customer.customer_id">
              {{ customer.customer_name }}
            </ng-option>
          </ng-select>
          <span class="text-xs text-red-500"
            *ngIf="(customerId.invalid && customerId.touched) || (projectNgForm.submitted && customerId.invalid)">
            Required
          </span>
        </div>
  
        <!-- Project Name -->
        <div class="space-y-1">
          <label class="text-xs font-medium text-gray-600">Project Name*</label>
          <input type="text" required 
            class="text-xs w-full px-2 py-1 border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500" 
            [(ngModel)]="projectForm.project_name" #projectName="ngModel" name="project_name"
            [ngClass]="{'border-red-500': (projectName.invalid && projectName.touched) || (projectNgForm.submitted && projectName.invalid)}">
          <span class="text-xs text-red-500"
            *ngIf="(projectName.invalid && projectName.touched) || (projectNgForm.submitted && projectName.invalid)">
            Required
          </span>
        </div>
  
        <!-- Planned Start Date -->
        <div class="space-y-1">
          <label class="text-xs font-medium text-gray-600">Planned Start Date*</label>
          <input type="date" required 
            class="text-xs w-full px-2 py-1 border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500" 
            [(ngModel)]="projectForm.planned_start_date" #plannedStartDate="ngModel" name="planned_start_date"
            [ngClass]="{'border-red-500': (plannedStartDate.invalid && plannedStartDate.touched) || (projectNgForm.submitted && plannedStartDate.invalid)}">
          <span class="text-xs text-red-500"
            *ngIf="(plannedStartDate.invalid && plannedStartDate.touched) || (projectNgForm.submitted && plannedStartDate.invalid)">
            Required
          </span>
        </div>
  
        <!-- Actual Start Date -->
        <div class="space-y-1">
          <label class="text-xs font-medium text-gray-600">Actual Start Date*</label>
          <input type="date" required 
            class="text-xs w-full px-2 py-1 border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500" 
            [(ngModel)]="projectForm.actual_start_date" #actualStartDate="ngModel" name="actual_start_date"
            [ngClass]="{'border-red-500': (actualStartDate.invalid && actualStartDate.touched) || (projectNgForm.submitted && actualStartDate.invalid)}">
          <span class="text-xs text-red-500"
            *ngIf="(actualStartDate.invalid && actualStartDate.touched) || (projectNgForm.submitted && actualStartDate.invalid)">
            Required
          </span>
        </div>
  
        <!-- Type of Project -->
        <div class="space-y-1">
          <label class="text-xs font-medium text-gray-600">Type of Project*</label>
          <ng-select required class="text-xs custom-ng-select" [(ngModel)]="projectForm.type_of_project_id"
            #typeOfProjectId="ngModel" name="type_of_project_id"
            [ngClass]="{'border-red-500': (typeOfProjectId.invalid && typeOfProjectId.touched) || (projectNgForm.submitted && typeOfProjectId.invalid)}">
            <ng-option [value]="" disabled selected>Select Type</ng-option>
            <ng-option *ngFor="let project of optionTypeOfProject" [value]="project.type_of_project_id">
              {{ project.project_type_name }}
            </ng-option>
          </ng-select>
          <span class="text-xs text-red-500"
            *ngIf="(typeOfProjectId.invalid && typeOfProjectId.touched) || (projectNgForm.submitted && typeOfProjectId.invalid)">
            Required
          </span>
        </div>
  
        <!-- Type of Engagement -->
        <div class="space-y-1">
          <label class="text-xs font-medium text-gray-600">Type of Engagement*</label>
          <ng-select required class="text-xs custom-ng-select" [(ngModel)]="projectForm.type_of_engagement_id"
            #typeOfEngagementId="ngModel" name="type_of_engagement_id"
            [ngClass]="{'border-red-500': (typeOfEngagementId.invalid && typeOfEngagementId.touched) || (projectNgForm.submitted && typeOfEngagementId.invalid)}">
            <ng-option [value]="" disabled selected>Select Engagement</ng-option>
            <ng-option *ngFor="let engagement of optionTypeOfEngagement" [value]="engagement.type_of_engagement_id">
              {{ engagement.type_of_engagement_name }}
            </ng-option>
          </ng-select>
          <span class="text-xs text-red-500"
            *ngIf="(typeOfEngagementId.invalid && typeOfEngagementId.touched) || (projectNgForm.submitted && typeOfEngagementId.invalid)">
            Required
          </span>
        </div>
  
        <!-- Project Manager -->
        <div class="space-y-1">
          <label class="text-xs font-medium text-gray-600">Project Manager*</label>
          <ng-select required class="text-xs custom-ng-select" [(ngModel)]="projectForm.project_manager_id"
            #projectManagerId="ngModel" name="project_manager_id"
            [ngClass]="{'border-red-500': (projectManagerId.invalid && projectManagerId.touched) || (projectNgForm.submitted && projectManagerId.invalid)}">
            <ng-option [value]="" disabled selected>Select Manager</ng-option>
            <ng-option *ngFor="let user of optionUsers" [value]="user.user_id">
              {{ user.user_first_name }} {{ user.user_last_name }}
            </ng-option>
          </ng-select>
          <span class="text-xs text-red-500"
            *ngIf="(projectManagerId.invalid && projectManagerId.touched) || (projectNgForm.submitted && projectManagerId.invalid)">
            Required
          </span>
        </div>
  
        <!-- Project Status -->
        <div class="space-y-1">
          <label class="text-xs font-medium text-gray-600">Project Status*</label>
          <ng-select required class="text-xs custom-ng-select" [(ngModel)]="projectForm.project_status_id"
            #projectStatusId="ngModel" name="project_status_id"
            [ngClass]="{'border-red-500': (projectStatusId.invalid && projectStatusId.touched) || (projectNgForm.submitted && projectStatusId.invalid)}">
            <ng-option [value]="" disabled selected>Select Status</ng-option>
            <ng-option *ngFor="let status of optionProjectStatus" [value]="status.project_status_id">
              {{ status.status_name }}
            </ng-option>
          </ng-select>
          <span class="text-xs text-red-500"
            *ngIf="(projectStatusId.invalid && projectStatusId.touched) || (projectNgForm.submitted && projectStatusId.invalid)">
            Required
          </span>
        </div>
  
        <!-- Tentative End Date -->
        <div class="space-y-1">
          <label class="text-xs font-medium text-gray-600">Tentative End Date*</label>
          <input type="date" required 
            class="text-xs w-full px-2 py-1 border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500" 
            [(ngModel)]="projectForm.tentative_end_date" #tentativeEndDate="ngModel" name="tentative_end_date"
            [ngClass]="{'border-red-500': (tentativeEndDate.invalid && tentativeEndDate.touched) || (projectNgForm.submitted && tentativeEndDate.invalid)}">
          <span class="text-xs text-red-500"
            *ngIf="(tentativeEndDate.invalid && tentativeEndDate.touched) || (projectNgForm.submitted && tentativeEndDate.invalid)">
            Required
          </span>
        </div>
  
        <!-- Project Description -->
        <div class="space-y-1 col-span-3">
          <label class="text-xs font-medium text-gray-600">Project Description</label>
          <textarea rows="3" placeholder="Enter project details..."
            class="text-xs w-full px-2 py-1 border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"
            [(ngModel)]="projectForm.project_description" name="project_description"></textarea>
        </div>
      </div>
  
      <!-- Submit Button -->
      <div class="mt-6 flex justify-center">
        <button type="submit"
          class="flex items-center text-xs bg-gradient-to-r from-blue-600 to-blue-700 text-white px-4 py-2 rounded-md hover:from-blue-700 hover:to-blue-800 transition-all shadow-sm">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
          </svg>
          Create Project
        </button>
      </div>
    </form>
    </div>
  
  
   
    <div class="rounded-lg w-full overflow-x-auto">

      <!-- Filter Section -->
      <div class="min-w-max">
        <div
          class="flex flex-wrap items-center justify-between gap-x-2 gap-y-4 mb-4 py-2 bg-gray-50 rounded shadow-sm w-full">
          <!-- Project Name Filter -->
          <div class="relative flex-grow">
            <label class="block text-xs font-medium text-gray-700 mb-1">Project</label>
            <ng-select [(ngModel)]="projectNameFilterOfProject" (change)="applyProjectFilters()" [clearable]="true"
              [searchable]="true" class="text-xs custom-ng-select-filter">
              <ng-option *ngFor="let project of optionProject" [value]="project.project_id">
                {{ project.project_name }}
              </ng-option>
            </ng-select>
          </div>

          <!-- Customer Name Filter -->
          <div class="relative flex-grow">
            <label class="block text-xs font-medium text-gray-700 mb-1">Customer</label>
            <ng-select [(ngModel)]="projectCustomerNameFilter" (change)="applyProjectFilters()" [clearable]="true"
              [searchable]="true" class="text-xs custom-ng-select-filter">
              <ng-option *ngFor="let customer of optionCustomers" [value]="customer.customer_id">
                {{ customer.customer_name }}
              </ng-option>
            </ng-select>
          </div>

          <!-- Project Manager Filter -->
          <div class="relative flex-grow">
            <label class="block text-xs font-medium text-gray-700 mb-1">Project Manager</label>
            <ng-select [(ngModel)]="projectManagerFilterOfProject" (change)="applyProjectFilters()" [clearable]="true"
              [searchable]="true" class="text-xs custom-ng-select-filter">
              <ng-option *ngFor="let manager of optionProjectManagers" [value]="manager.user_id">
                {{ manager.user_first_name }} {{ manager.user_last_name }}
              </ng-option>
            </ng-select>
          </div>

          <div class="relative flex-grow">
            <label class="block text-xs font-medium text-gray-700 mb-1">Type of Project</label>
            <ng-select [(ngModel)]="typeOfProjectFilter" (change)="applyProjectFilters()" [clearable]="true"
              [searchable]="true" class="text-xs custom-ng-select-filter">
              <ng-option *ngFor="let project of optionTypeOfProject" [value]="project.type_of_project_id">
                {{ project.project_type_name }}
              </ng-option>
            </ng-select>
          </div>

          <div class="relative flex-grow">
            <label class="block text-xs font-medium text-gray-700 mb-1">Type of Engagement</label>
            <ng-select [(ngModel)]="typeOfEngagementFilter" (change)="applyProjectFilters()" [clearable]="true"
              [searchable]="true" class="text-xs custom-ng-select-filter">
              <ng-option *ngFor="let engagement of optionTypeOfEngagement" [value]="engagement.type_of_engagement_id">
                {{ engagement.type_of_engagement_name }}
              </ng-option>
            </ng-select>
          </div>

          <!-- Project Status Filter (ng-select) -->
          <div class="relative flex-grow">
            <label class="block text-xs font-medium text-gray-700 mb-1">Project Status</label>
            <ng-select [(ngModel)]="projectStatusFilter" (change)="applyProjectFilters()" [clearable]="true"
              [searchable]="true" class="text-xs custom-ng-select-filter">
              <ng-option *ngFor="let status of optionProjectStatus" [value]="status.project_status_id">
                {{ status.status_name }}
              </ng-option>
            </ng-select>
          </div>

          <!-- Planned Start Date Filter -->
          <div class="relative flex-grow">
            <label class="block text-xs font-medium text-gray-700 mb-1">Planned Start Date</label>

            <input type="date" [(ngModel)]="plannedStartDateFilter" (change)="applyProjectFilters()"
              class="text-xs border border-gray-300 rounded px-1 py-1 w-full focus:outline-none focus:ring focus:ring-blue-300" />
            <button *ngIf="plannedStartDateFilter" (click)="clearProjectFilter('plannedStartDateFilter')"
              class="absolute inset-y-0 right-0 px-2 flex items-center text-gray-500 hover:text-gray-700">
              ×
            </button>
          </div>

          <!-- Actual Start Date Filter -->
          <div class="relative flex-grow">
            <label class="block text-xs font-medium text-gray-700 mb-1">Actual Start Date</label>

            <input type="date" [(ngModel)]="actualStartDateFilter" (change)="applyProjectFilters()"
              class="text-xs border border-gray-300 rounded px-1 py-1 w-full focus:outline-none focus:ring focus:ring-blue-300" />
            <button *ngIf="actualStartDateFilter" (click)="clearProjectFilter('actualStartDateFilter')"
              class="absolute inset-y-0 right-0 px-2 flex items-center text-gray-500 hover:text-gray-700">
              ×
            </button>
          </div>

          <!-- Tentative End Date Filter -->
          <div class="relative flex-grow">
            <label class="block text-xs font-medium text-gray-700 mb-1">Tentative End Date</label>

            <input type="date" [(ngModel)]="tentativeEndDateFilter" (change)="applyProjectFilters()"
              class="text-xs border border-gray-300 rounded px-1 py-1 w-full focus:outline-none focus:ring focus:ring-blue-300" />
            <button *ngIf="tentativeEndDateFilter" (click)="clearProjectFilter('tentativeEndDateFilter')"
              class="absolute inset-y-0 right-0 px-2 flex items-center text-gray-500 hover:text-gray-700">
              ×
            </button>
          </div>

          <!-- Project Description Filter -->
          <div class="relative flex-grow">
            <label class="block text-xs font-medium text-gray-700 mb-1">Project Description</label>

            <input type="text" [(ngModel)]="projectDescriptionFilter" (input)="applyProjectFilters()"
              placeholder="Search Project Description"
              class="text-xs border border-gray-300 rounded px-1 py-1 w-full focus:outline-none focus:ring focus:ring-blue-300" />
            <button *ngIf="projectDescriptionFilter" (click)="clearProjectFilter('projectDescriptionFilter')"
              class="absolute inset-y-0 right-0 px-2 flex items-center text-gray-500 hover:text-gray-700">
              ×
            </button>
          </div>

          <!-- Clear All Filters -->
          <button (click)="clearProjectFilters()"
            class="text-xs bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600 focus:outline-none flex-grow-0">Clear
            All Filters</button>
        </div>
      </div>

      <!-- Scrollable Table -->
      <div class="rounded-lg w-full inline-block whitespace-nowrap">
        <table class="min-w-full text-xs border-collapse">
          <thead>
            <tr class="bg-gray-50">
              <th class="sticky left-0 px-1 py-1 border border-gray-300 border-b-gray-200 text-center bg-gray-50">#</th>
              <th class="px-1 py-1 border border-gray-200 text-center">Project</th>
              <th class="px-1 py-1 border border-gray-200 text-center">Customer</th>
              <th class="px-1 py-1 border border-gray-200 text-center">Manager</th>
              <th class="px-1 py-1 border border-gray-200 text-center">Project Type</th>
              <th class="px-1 py-1 border border-gray-200 text-center">Engagement</th>
              <th class="px-1 py-1 border border-gray-200 text-center">Status</th>
              <th class="px-1 py-1 border border-gray-200 text-center">Planned Start</th>
              <th class="px-1 py-1 border border-gray-200 text-center">Actual Start</th>
              <th class="px-1 py-1 border border-gray-200 text-center">Tentative End</th>
              <th class="px-1 py-1 border border-gray-200 text-center">Description</th>
              <th class="sticky right-0 px-1 py-1 border border-gray-200 text-center bg-gray-50">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let project of paginatedProjects; let i = index" class="hover:bg-gray-50">
              <td class="sticky left-0 px-1 py-1 border border-gray-300 border-b-gray-300 text-center bg-gray-50">{{ i + 1 }}</td>
              <td class="px-1 py-1 border border-gray-300 text-center">{{ project.project_name || '-' }}</td>
              <td class="px-1 py-1 border border-gray-300 text-center">{{ project.customer_name || '-' }}</td>
              <td class="px-1 py-1 border border-gray-300 text-center">{{ project.project_manager || '-' }}</td>
              <td class="px-1 py-1 border border-gray-300 text-center">{{ project.type_of_project || '-' }}</td>
              <td class="px-1 py-1 border border-gray-300 text-center">{{ project.type_of_engagement || '-' }}</td>
              <td class="px-1 py-1 border border-gray-300 text-center">{{ project.project_status || '-' }}</td>
              <td class="px-1 py-1 border border-gray-300 text-center">{{ project.planned_start_date | date:'dd-MMM-yyyy' }}</td>
              <td class="px-1 py-1 border border-gray-300 text-center">{{ project.actual_start_date | date:'dd-MMM-yyyy' }}</td>
              <td class="px-1 py-1 border border-gray-300 text-center">{{ project.tentative_end_date | date:'dd-MMM-yyyy' }}</td>
              <td class="px-1 py-1 border border-gray-300 text-center">
                <div class="group relative inline-block">
                  <span class="truncate max-w-[80px] inline-block">{{ project.project_description || '-' }}</span>
                  <div *ngIf="project.project_description" class="absolute z-20 hidden group-hover:block w-64 px-1 py-1 mb-2 text-xs text-gray-700 bg-white rounded shadow-lg border border-gray-300">
                    {{ project.project_description }}
                  </div>
                </div>
              </td>
              <td class="sticky right-0 px-1 py-1 border border-gray-300 border-b-gray-300 text-center bg-gray-50">
                <button (click)="openEditProjectModal(project)" class="text-green-600 hover:text-green-800 p-1" title="Edit">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                  </svg>
                </button>
                <button (click)="deleteProject(project.project_id)" class="text-red-600 hover:text-red-800 p-1" title="Delete">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                  </svg>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="flex items-center justify-center mt-4 space-x-1">
      <button (click)="changeProjectPage(projectCurrentPage - 1)" [disabled]="projectCurrentPage === 1"
        class="px-3 py-1 border rounded-md">
        Previous
      </button>

      <button *ngIf="projectCurrentPage > 3" (click)="changeProjectPage(1)" class="px-3 py-1 border rounded-md">
        1
      </button>

      <span *ngIf="projectCurrentPage > 4" class="px-2">...</span>

      <button *ngFor="let page of getVisibleProjectPageNumbers()" (click)="changeProjectPage(page)"
        [class.bg-blue-500]="projectCurrentPage === page" class="px-3 py-1 border rounded-md">
        {{ page }}
      </button>

      <span *ngIf="projectCurrentPage < projectTotalPages - 3" class="px-2">...</span>

      <button *ngIf="projectCurrentPage < projectTotalPages - 2" (click)="changeProjectPage(projectTotalPages)"
        class="px-3 py-1 border rounded-md">
        {{ projectTotalPages }}
      </button>

      <button (click)="changeProjectPage(projectCurrentPage + 1)" [disabled]="projectCurrentPage === projectTotalPages"
        class="px-3 py-1 border rounded-md">
        Next
      </button>
    </div>

    <div *ngIf="isEditProjectModalOpen"
    class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000]"
    (click)="closeEditProjectModal()">
    <div class="bg-white p-6 rounded-lg w-1/2" (click)="$event.stopPropagation()">
      <h3 class="text-xl font-semibold mb-4">Edit Project</h3>
      <form #editProjectForm="ngForm" (ngSubmit)="updateProject(editProjectForm); $event.preventDefault()">
        <div class="grid grid-cols-5 gap-4">

          <div class="form-group">
            <label class="block mb-2 font-semibold">Customer Name*</label>
            <ng-select required class="custom-ng-select" [(ngModel)]="editProjectFormData.customer_id"
              #editCustomerId="ngModel" name="customer_id"
              [ngClass]="{'border-red-500': (editCustomerId.invalid && editCustomerId.touched) || (editProjectForm.submitted && editCustomerId.invalid)}">
              <ng-option [value]="" disabled selected>Select Customer</ng-option>
              <ng-option *ngFor="let customer of optionCustomers" [value]="customer.customer_id">
                {{ customer.customer_name }}
              </ng-option>
            </ng-select>
            <span class="text-red-500 text-sm"
              *ngIf="(editCustomerId.invalid && editCustomerId.touched) || (editProjectForm.submitted && editCustomerId.invalid)">
              Customer Name is required
            </span>
          </div>

          <!-- Project Name -->
          <div class="form-group">
            <label class="block mb-2 font-semibold">Project Name*</label>
            <input type="text" required class="border p-2 w-full rounded-md"
              [(ngModel)]="editProjectFormData.project_name" #editProjectName="ngModel" name="project_name"
              [ngClass]="{'border-red-500': (editProjectName.invalid && editProjectName.touched) || (editProjectForm.submitted && editProjectName.invalid)}">
            <span class="text-red-500 text-sm"
              *ngIf="(editProjectName.invalid && editProjectName.touched) || (editProjectForm.submitted && editProjectName.invalid)">
              Project Name is required
            </span>
          </div>

          <!-- Planned Start Date -->
          <div class="form-group">
            <label class="block mb-2 font-semibold">Planned Start Date*</label>
            <input type="date" required class="border p-2 w-full rounded-md"
              [(ngModel)]="editProjectFormData.planned_start_date" #editPlannedStartDate="ngModel"
              name="planned_start_date"
              [ngClass]="{'border-red-500': (editPlannedStartDate.invalid && editPlannedStartDate.touched) || (editProjectForm.submitted && editPlannedStartDate.invalid)}">
            <span class="text-red-500 text-sm"
              *ngIf="(editPlannedStartDate.invalid && editPlannedStartDate.touched) || (editProjectForm.submitted && editPlannedStartDate.invalid)">
              Planned Start Date is required
            </span>
          </div>

          <!-- Actual Start Date -->
          <div class="form-group">
            <label class="block mb-2 font-semibold">Actual Start Date</label>
            <input type="date" class="border p-2 w-full rounded-md"
              [(ngModel)]="editProjectFormData.actual_start_date" name="actual_start_date">
          </div>


          <div class="form-group">
            <label class="block mb-2 font-semibold">Type of Project*</label>
            <ng-select required class="custom-ng-select" [(ngModel)]="editProjectFormData.type_of_project_id"
              #editTypeOfProjectId="ngModel" name="type_of_project_id"
              [ngClass]="{'border-red-500': (editTypeOfProjectId.invalid && editTypeOfProjectId.touched) || (editProjectForm.submitted && editTypeOfProjectId.invalid)}">
              <ng-option [value]="" disabled selected>Select Type</ng-option>
              <ng-option *ngFor="let project of optionTypeOfProject" [value]="project.type_of_project_id">
                {{ project.project_type_name }}
              </ng-option>
            </ng-select>
            <span class="text-red-500 text-sm"
              *ngIf="(editTypeOfProjectId.invalid && editTypeOfProjectId.touched) || (editProjectForm.submitted && editTypeOfProjectId.invalid)">
              Type of Project is required
            </span>
          </div>


          <div class="form-group">
            <label class="block mb-2 font-semibold">Type of Engagement*</label>
            <ng-select required class="custom-ng-select" [(ngModel)]="editProjectFormData.type_of_engagement_id"
              #editTypeOfEngagementId="ngModel" name="type_of_engagement_id"
              [ngClass]="{'border-red-500': (editTypeOfEngagementId.invalid && editTypeOfEngagementId.touched) || (editProjectForm.submitted && editTypeOfEngagementId.invalid)}">
              <ng-option [value]="" disabled selected>Select Type of Engagement</ng-option>
              <ng-option *ngFor="let engagement of optionTypeOfEngagement" [value]="engagement.type_of_engagement_id">
                {{ engagement.type_of_engagement_name }}
              </ng-option>
            </ng-select>
            <span class="text-red-500 text-sm"
              *ngIf="(editTypeOfEngagementId.invalid && editTypeOfEngagementId.touched) || (editProjectForm.submitted && editTypeOfEngagementId.invalid)">
              Type of Engagement is required
            </span>
          </div>

          <!-- Project Manager -->
          <div class="form-group">
            <label class="block mb-2 font-semibold">Project Manager*</label>
            <ng-select required class="custom-ng-select" [(ngModel)]="editProjectFormData.project_manager_id"
              #editProjectManagerId="ngModel" name="project_manager_id"
              [ngClass]="{'border-red-500': (editProjectManagerId.invalid && editProjectManagerId.touched) || (editProjectForm.submitted && editProjectManagerId.invalid)}">
              <ng-option [value]="" disabled selected>Select Project Manager</ng-option>
              <ng-option *ngFor="let user of optionUsers" [value]="user.user_id">
                {{ user.user_first_name }} {{ user.user_last_name }}
              </ng-option>
            </ng-select>
            <span class="text-red-500 text-sm"
              *ngIf="(editProjectManagerId.invalid && editProjectManagerId.touched) || (editProjectForm.submitted && editProjectManagerId.invalid)">
              Project Manager is required
            </span>
          </div>

          <!-- Project Status -->
          <div class="form-group">
            <label class="block mb-2 font-semibold">Project Status*</label>
            <ng-select required class="custom-ng-select" [(ngModel)]="editProjectFormData.project_status_id"
              #editProjectStatusId="ngModel" name="project_status_id"
              [ngClass]="{'border-red-500': (editProjectStatusId.invalid && editProjectStatusId.touched) || (editProjectForm.submitted && editProjectStatusId.invalid)}">
              <ng-option [value]="" disabled selected>Select Status</ng-option>
              <ng-option *ngFor="let status of optionProjectStatus" [value]="status.project_status_id">
                {{ status.status_name }}
              </ng-option>
            </ng-select>
            <span class="text-red-500 text-sm"
              *ngIf="(editProjectStatusId.invalid && editProjectStatusId.touched) || (editProjectForm.submitted && editProjectStatusId.invalid)">
              Project Status is required
            </span>
          </div>

          <!-- Tentative End Date -->
          <div class="form-group">
            <label class="block mb-2 font-semibold">Tentative End Date</label>
            <input type="date" class="border p-2 w-full rounded-md"
              [(ngModel)]="editProjectFormData.tentative_end_date" name="tentative_end_date">
          </div>

          <!-- Project Description -->
          <div class="form-group">
            <label class="block mb-2 font-semibold">Project Description</label>
            <textarea class="border p-2 w-full rounded-md" rows="3" placeholder="Enter project details..."
              [(ngModel)]="editProjectFormData.project_description" name="project_description"></textarea>
          </div>
        </div>

        <!-- Submit Button -->
        <div class="mt-4">
          <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">Update</button>
        </div>
      </form>
    </div>
  </div>
  </div>
</div>